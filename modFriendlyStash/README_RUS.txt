modFriendlyStash
================

Мод предназначен для игры с установленным UPatch.

Описание:
=========

Мод упрощает доступ к предметам в тайнике: можно настроить доступ как нравится и разрешить использовать ингредиенты и компоненты из инвентаря напрямую для алхимии и крафта. Можно также использовать Плотву в качестве тайника.

По умолчанию меню тайника доступно только для просмотра по нажатию клавиши U или через общий хаб. Предметы из тайника используются для алхимии, крафта, разбора и починки у алхимиков и кузнецов/бронников.

Доступ для каждого режима настраивается отдельно: меню тайника, магазин, алхимия и крафт/разбор. Можно отключить доступ совсем, разрешить полный доступ или сделать так, что тайник будет доступен только в поселениях или на определённом расстояние (расстояние тоже настраивается).

Плотву можно использовать в качестве мобильного тайника: с раздельным ограничением веса для игрока и лошади и доступом, основанном на расстоянии. Настройте макс. расстояние и нажмите U для доступа к меню тайника и передачи предметов, или же подзовите лошадь, чтобы получить возможность продавать/разбирать/крафтить предметы с использованием тайника.

Для тайника также сделан новый режим синхронизации: если он включен, то тайник отображает только предметы из соответствующей вкладки инвентаря игрока, которая в данный момент активна. Если синхронизация отключена, тайник отображает все предметы, как в ванилле.

Базовый предельный носимый вес для игрока и лошади настраиваются в меню мода, также как и бонус от седельных сумок.

Назначения клавиш по-умолчанию:
===============================

"U" (Хаб -> Глоссарий -> Тайник) - открыть меню тайника.
"T" (R2 на контроллере) - переключить инвентарь (игрок/тайник) в меню магазина/разбора/починки/зачарования.
"T" (R2 на контроллере) - вкл/выкл синхронизацию тайника в меню тайника.
"H" (X на контроллере) - показать информацию о загрузке лошади в меню тайника.

Настройка:
==========

Все опции доступны во внутриигровом меню - ищите "Моды" и "Friendly Stash".

Опция "Использовать Плотву как тайник" предполагается для использования совместно с доступом к тайнику, ограниченным по расстоянию.

Опция "Использовать сумки для Плотвы" убирает бонусный вес седельных сумок с Геральта и переносит его на Плотву. Инвентарь Плотвы работает также, как и инвентарь игрока: если Плотва перегружена, она не сможет скакать галопом и Геральт не сможет позвать её на расстоянии свистом. Если Геральт перегружен и находится на лошади, галоп также будет недоступен.

Установка:
==========

Для установки мода рекомендуется использовать The Witcher 3 Mod Manager (TW3MM), доступный для скачивания на Nexus Mods. TW3MM устанавливает все части мода автоматически, дополнительная ручная правка файлов не требуется.

Nexus Mod Manager (NMM) устанавливает мод не полностью, т.к. он не поддерживает установку меню и горячих клавиш, поэтому пользователям NMM всё равно необходимо проделать шаги 3 и 4 ручной установки!

Решение конфликтов с другими модами
===================================

При наличии других модов конфликты устраняются с помощью программы Script Merger. При этом надо убедиться, что все установленные моды поддерживают вашу версию игры, иначе конфликты скорее всего разрешить не удастся.

Ручная установка:
=================

1. Создание резервной копии (не обязательно)

Поскольку некоторые моды (включая этот) меняют файлы конфигурации, не повредит сделать резервную копию папки "[Path To The Witcher 3]\bin\config" (в случае если подобные моды ранее не устанавливались и папка всё ещё ванильная).

2. Установка основных файлов мода

Для установки основных файлов мода необходимо распаковать и скопировать папку "modFriendlyStash" в "[Путь куда установлена The Witcher 3]\Mods". Если папка "Mods" не существует, её нужно создать. Основные файлы можно установить с помощью NMM, но привязки клавиш и настройки для игрового меню всё равно придётся устанавливать вручную (см. ниже).

3. Установка внутриигрового меню и горячих клавиш

Для работы игрового меню необходим файл modFriendlyStashConfig.xml в папке "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc" folder.

Для работы новых горячих клавиш, их необходимо добавить в файл "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc\input.xml".

3.1. Быстрая установка

Если у вас нет других модов, добавляющих горячие клавиши, просто скопируйте папку "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash\bin" в папку "[Путь куда установлена The Witcher 3]". Если всё сделано правильно, то появится окно, с вопросом хотите ли вы перезаписать существующий файл input.xml. Выберите "перезаписать", чтобы заменить исходный файл input.xml модифицированным.

3.2. Ручная установка

Если у вас уже установлены другие моды, добавляющие горячие клавиши, вы почти наверняка не захотите перезаписывать input.xml. В этом случае для установки горячих клавиш нужно открыть файлы "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc\input.xml" и "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash\bin\config\r4game\user_config_matrix\pc\input.xml" и скопировать изменения modFriendlyStash вручную (они помещены внутрь комментариев "modFriendlyStash begin" и "modFriendlyStash end") в аналогичную часть существующего файла.

Также необходимо скопировать файл "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash\bin\config\r4game\user_config_matrix\pc\modFriendlyStashConfig.xml" в папку "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc" для установки меню.

4. Инициализация установок мода по умолчанию и горячих клавиш

Установки мода хранятся в файле "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\user.settings".

Привязки клавиш хранятся в файле "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\input.settings".

Для инициализации настроек мода по-умолчанию необходимо открыть "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\user.settings" и "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash\user.settings.part.txt" из мода. Выделить всё в файле "user.settings.part.txt", скопировать и вставить в начало файла "user.settings". Если пропустить этот шаг, почти все функции мода будут отключены и будет казаться, что мод не работает или работает неправильно.

Для инициализации горячих клавиш необходимо открыть "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\input.settings" и "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash\input.settings.part.txt" из мода, выделить всё в файле "input.settings.part.txt", скопировать и вставить в начало файла "input.settings". Если пропустить этот шаг, то клавиши будут отображаться в меню, но назначить их нормально не получится.

5. Решение конфликтов с другими модами

При наличии других модов конфликты устраняются с помощью программы Script Merger. При этом надо убедиться, что все установленные моды поддерживают вашу версию игры, иначе конфликты скорее всего разрешить не удастся.

Обновление:
===========

Удаление старой версии и установка новой - наиболее безопасный способ. Причём если мод удалялся через TW3MM/NMM, необходимо убедиться, что папка "[Path To The Witcher 3]\Mods\modFriendlyStash" действительно была удалена. Если в списке изменений нет новых клавиш и опций меню, то никакие другие действия, кроме установки основных файлов, не требуются.

Если обновление содержит новые горячие клавиши, проще всего удалить файл "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\input.settings", запустить игру один раз, чтобы получить новый файл с настройками по умолчанию и затем повторить шаги 3 и 4 описанного выше процесса установки.

Если обновление содержит новые опции меню, проще всего удалить файл "C:\Users\[Имя Пользователя]\Documents\The Witcher 3\user.settings", запустить игру один раз, чтобы получить новый файл с настройками по умолчанию и затем повторить шаги 3 и 4 описанного выше процесса установки.

Внимание! Не забудьте восстановить пользовательские настройки после удаления файлов input.settings и user.settings!

При наличии других модов, после установки надо удалить существующие объединения в ScriptMerger и объединить всё заново.

Удаление:
=========

Если вы ставили мод с помощью TW3MM, просто выберите пункт "удаление" и все части мода будут удалены полностью автоматически.

Не забудьте после удаления запустить Script Merger.

Ручное удаление:
================

1. Удаление основных файлов мода

Использовать NMM или удалить вручную папку мода "[Путь куда установлена The Witcher 3]\Mods\modFriendlyStash".

2. Удаление меню и горячих клавиш

Для удаления меню надо удалить файл modFriendlyStashConfig.xml из папки "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc".

Для удаления горячих клавиш их необходимо убрать из файла "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc\input.xml".

2.1. Быстрое удаление с использованием резервной копии

Если у вас есть резервная копия папки "[Путь куда установлена The Witcher 3]\bin\config" и нет других модов, меняющих файлы конфигурации, просто удалите папку "[Путь куда установлена The Witcher 3]\bin\config" и скопируйте на её место папку "config" из резервной копии.

2.2. Ручное удаление

Для удаления горячих клавиш откройте файл "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc\input.xml" и удалите всё между комментариями "modFriendlyStash begin" и "modFriendlyStash end".

Для удаления меню просто удалите файл "[Путь куда установлена The Witcher 3]\bin\config\r4game\user_config_matrix\pc\modFriendlyStashConfig.xml".

3. Конфликты с другими модами

При наличии других модов, после удаления надо объединить всё заново в ScriptMerger.
